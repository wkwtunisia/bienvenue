<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WKW Automotive Tunisia - Portail Interne</title>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    :root { --red:#e63946; --glass:rgba(255,255,255,0.1); }
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
    body{background:linear-gradient(135deg,#1d3557,#457b9d);color:white;min-height:100vh;overflow-x:hidden;}
    header{position:fixed;top:0;left:0;right:0;z-index:1000;background:var(--glass);backdrop-filter:blur(15px);border-bottom:1px solid rgba(255,255,255,0.1);padding:15px 20px;display:flex;align-items:center;justify-content:space-between;}
    .logo img{height:65px;filter:drop-shadow(0 0 10px rgba(230,57,70,0.6));transition:.4s;}
    .logo img:hover{transform:scale(1.1);}
    .titles{text-align:center;flex:1;}
    .fixed-title{font-size:2.4rem;font-weight:900;background:linear-gradient(90deg,#fff,var(--red));-webkit-background-clip:text;color:transparent;}
    .editable-title{margin-top:10px;font-size:1.1rem;background:var(--glass);padding:12px 20px;border-radius:12px;backdrop-filter:blur(10px);max-width:90%;margin:auto;line-height:1.7;}
    .menu-btn{position:fixed;left:20px;top:100px;z-index:1002;width:60px;height:60px;border-radius:50%;background:var(--red);border:none;color:white;font-size:1.8rem;box-shadow:0 0 30px rgba(230,57,70,0.7);cursor:pointer;animation:pulse 2s infinite;}
    .menu-btn:hover{transform:scale(1.15);}
    @keyframes pulse{0%,100%{box-shadow:0 0 30px rgba(230,57,70,0.7);}50%{box-shadow:0 0 50px rgba(230,57,70,1);}}
    .sidebar{position:fixed;left:-300px;top:0;bottom:0;width:300px;background:rgba(10,10,10,0.95);backdrop-filter:blur(20px);transition:all .5s cubic-bezier(.68,-.55,.27,1.55);z-index:1001;padding-top:120px;box-shadow:5px 0 30px rgba(0,0,0,0.6);}
    .sidebar.open{left:0;}
    .sidebar::before{content:'';position:absolute;top:0;left:0;right:0;height:120px;background:linear-gradient(135deg,var(--red),#a4161a);clip-path:polygon(0 0,100% 0,100% 70%,0 100%);}
    .sidebar button{display:flex;align-items:center;width:100%;padding:18px 30px;color:white;background:none;border:none;font-size:1.3rem;transition:.3s;cursor:pointer;}
    .sidebar button:hover{background:rgba(230,57,70,0.3);padding-left:45px;transform:translateX(10px);}
    .sidebar i{margin-right:18px;font-size:1.5rem;width:30px;}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);opacity:0;visibility:hidden;transition:.4s;z-index:1000;}
    .overlay.active{opacity:1;visibility:visible;}
    .main{margin-top:100px;padding:30px 20px;}
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;margin-top:30px;}
    .card{background:var(--glass);backdrop-filter:blur(15px);border-radius:20px;padding:35px 25px;text-align:center;border:1px solid rgba(255,255,255,0.2);transition:.5s;position:relative;overflow:hidden;}
    .card::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent);transition:.7s;}
    .card:hover::before{left:100%;}
    .card:hover{transform:translateY(-20px) scale(1.03);box-shadow:0 20px 40px rgba(230,57,70,0.4);}
    .card i{font-size:4rem;color:var(--red);margin-bottom:20px;text-shadow:0 0 20px rgba(230,57,70,0.6);}
    .admin-panel{max-width:1100px;margin:120px auto;background:var(--glass);backdrop-filter:blur(20px);padding:40px;border-radius:20px;border:1px solid rgba(255,255,255,0.2);display:none;}
    textarea,input{width:100%;padding:15px;margin:12px 0;border:none;border-radius:12px;background:rgba(255,255,255,0.2);color:white;}
    button{background:var(--red);padding:14px 32px;border-radius:12px;border:none;color:white;cursor:pointer;}
    @media(max-width:768px){.fixed-title{font-size:1.8rem;}.menu-btn{left:15px;top:90px;}.sidebar{width:280px;left:-280px;}}
  </style>
</head>
<body>

<header>
  <div class="logo"><img src="https://3dologie.com/wp-content/uploads/2024/07/WKW-Automotive-Logo.png" alt="WKW"></div>
  <div class="titles">
    <div class="fixed-title">WKW Automotive Tunisia</div>
    <div class="editable-title" id="editableTitle" data-aos="fade-down">Chargement du message d'accueil...</div>
  </div>
</header>

<button class="menu-btn" onclick="toggleSidebar()">Menu</button>
<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<nav class="sidebar" id="sidebar">
  <button onclick="showAdminPanel()">Login Admin</button>
</nav>

<div class="main">
  <div class="cards">
    <div class="card" data-aos="zoom-in" data-aos-delay="100"><i class="fas fa-calendar-check"></i><h3 id="c1t">Planning des visites</h3><p id="c1p">Réservation en ligne...</p></div>
    <div class="card" data-aos="zoom-in" data-aos-delay="300"><i class="fas fa-utensils"></i><h3 id="c2t">Horaires restauration</h3><p id="c2p">Menus du jour...</p></div>
    <div class="card" data-aos="zoom-in" data-aos-delay="500"><i class="fas fa-shield-alt"></i><h3 id="c3t">Consignes de sécurité</h3><p id="c3p">Port EPI obligatoire...</p></div>
  </div>
</div>

<div class="admin-panel" id="adminPanel">
  <h2 style="text-align:center;font-size:2rem;margin-bottom:30px;">Administration</h2>
  <div id="loginForm">
    <input type="email" id="email" placeholder="Email" value="admin@wkw.tn"><br>
    <input type="password" id="pass" placeholder="Mot de passe"><br>
    <button onclick="login()">Connexion</button>
  </div>
  <div id="editForm" style="display:none;">
    <h3>Titre modifiable</h3><textarea id="mainTitle" rows="7"></textarea><br>
    <h3>Carte 1</h3><input type="text" id="card1Title"><textarea id="card1Text" rows="3"></textarea><br>
    <h3>Carte 2</h3><input type="text" id="card2Title"><textarea id="card2Text" rows="3"></textarea><br>
    <h3>Carte 3</h3><input type="text" id="card3Title"><textarea id="card3Text" rows="3"></textarea><br>
    <button onclick="saveContent()">Sauvegarder</button>
    <button onclick="logout()" style="background:#666;">Déconnexion</button>
  </div>
</div>

<script>
  const SUPABASE_URL = 'https://ton-projet.supabase.co';        // Change ici
  const SUPABASE_ANON_KEY = 'ta-cle-anon';                       // Change ici
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  function toggleSidebar(){document.getElementById('sidebar').classList.toggle('open');document.getElementById('overlay').classList.toggle('active');}
  function showAdminPanel(){document.getElementById('adminPanel').style.display='block';toggleSidebar();}

  async function loadContent(){
    const {data}=await supabase.from('portal_content').select('*').eq('id',1).single();
    if(data){
      document.getElementById('editableTitle').textContent=data.main_title||'Bienvenue !';
      document.getElementById('c1t').textContent=data.card1_title;
      document.getElementById('c1p').textContent=data.card1_text;
      document.getElementById('c2t').textContent=data.card2_title;
      document.getElementById('c2p').textContent=data.card2_text;
      document.getElementById('c3t').textContent=data.card3_title;
      document.getElementById('c3p').textContent=data.card3_text;
    }
  }
  async function login(){
    const {error}=await supabase.auth.signInWithPassword({email:document.getElementById('email').value,password:document.getElementById('pass').value});
    if(error)return alert(error.message);
    document.getElementById('loginForm').style.display='none';
    document.getElementById('editForm').style.display='block';
    const {data}=await supabase.from('portal_content').select('*').eq('id',1).single();
    document.getElementById('mainTitle').value=data?.main_title||'';
    document.getElementById('card1Title').value=data?.card1_title||'';
    document.getElementById('card1Text').value=data?.card1_text||'';
    document.getElementById('card2Title').value=data?.card2_title||'';
    document.getElementById('card2Text').value=data?.card2_text||'';
    document.getElementById('card3Title').value=data?.card3_title||'';
    document.getElementById('card3Text').value=data?.card3_text||'';
  }
  async function saveContent(){
    await supabase.from('portal_content').update({
      main_title:document.getElementById('mainTitle').value,
      card1_title:document.getElementById('card1Title').value,
      card1_text:document.getElementById('card1Text').value,
      card2_title:document.getElementById('card2Title').value,
      card2_text:document.getElementById('card2Text').value,
      card3_title:document.getElementById('card3Title').value,
      card3_text:document.getElementById('card3Text').value,
    }).eq('id',1);
    alert("Sauvegardé !");loadContent();
  }
  function logout(){supabase.auth.signOut();document.getElementById('adminPanel').style.display='none';}

  AOS.init({duration:1000,once:true});
  loadContent();
</script>
</body>
</html>
